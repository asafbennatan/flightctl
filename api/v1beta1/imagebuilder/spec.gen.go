// Package imagebuilder provides primitives to interact with the openapi HTTP API.
//
// Code generated by github.com/oapi-codegen/oapi-codegen/v2 version v2.3.0 DO NOT EDIT.
package imagebuilder

import (
	"bytes"
	"compress/gzip"
	"encoding/base64"
	"fmt"
	"net/url"
	"path"
	"strings"

	"github.com/getkin/kin-openapi/openapi3"
)

// Base64 encoded, gzipped, json marshaled Swagger object
var swaggerSpec = []string{

	"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",
	"KsK8wWz3ZvdHAAAA//86hiFc2TYAAA==",
}

// GetSwagger returns the content of the embedded swagger specification file
// or error if failed to decode
func decodeSpec() ([]byte, error) {
	zipped, err := base64.StdEncoding.DecodeString(strings.Join(swaggerSpec, ""))
	if err != nil {
		return nil, fmt.Errorf("error base64 decoding spec: %w", err)
	}
	zr, err := gzip.NewReader(bytes.NewReader(zipped))
	if err != nil {
		return nil, fmt.Errorf("error decompressing spec: %w", err)
	}
	var buf bytes.Buffer
	_, err = buf.ReadFrom(zr)
	if err != nil {
		return nil, fmt.Errorf("error decompressing spec: %w", err)
	}

	return buf.Bytes(), nil
}

var rawSpec = decodeSpecCached()

// a naive cached of a decoded swagger spec
func decodeSpecCached() func() ([]byte, error) {
	data, err := decodeSpec()
	return func() ([]byte, error) {
		return data, err
	}
}

// Constructs a synthetic filesystem for resolving external references when loading openapi specifications.
func PathToRawSpec(pathToFile string) map[string]func() ([]byte, error) {
	res := make(map[string]func() ([]byte, error))
	if len(pathToFile) > 0 {
		res[pathToFile] = rawSpec
	}

	return res
}

// GetSwagger returns the Swagger specification corresponding to the generated code
// in this file. The external references of Swagger specification are resolved.
// The logic of resolving external references is tightly connected to "import-mapping" feature.
// Externally referenced files must be embedded in the corresponding golang packages.
// Urls can be supported but this task was out of the scope.
func GetSwagger() (swagger *openapi3.T, err error) {
	resolvePath := PathToRawSpec("")

	loader := openapi3.NewLoader()
	loader.IsExternalRefsAllowed = true
	loader.ReadFromURIFunc = func(loader *openapi3.Loader, url *url.URL) ([]byte, error) {
		pathToFile := url.String()
		pathToFile = path.Clean(pathToFile)
		getSpec, ok := resolvePath[pathToFile]
		if !ok {
			err1 := fmt.Errorf("path not found: %s", pathToFile)
			return nil, err1
		}
		return getSpec()
	}
	var specData []byte
	specData, err = rawSpec()
	if err != nil {
		return
	}
	swagger, err = loader.LoadFromData(specData)
	if err != nil {
		return
	}
	return
}
